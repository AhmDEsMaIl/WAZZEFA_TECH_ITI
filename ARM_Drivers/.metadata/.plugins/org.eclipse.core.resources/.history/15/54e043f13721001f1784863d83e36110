#include "STD_TYPES.h"
#include "BIT_MATH.h"
#include "UART_interface.h"
#include "UART_private.h"
#include "UART_config.h"

/*
 * BAUD RATE = CLK/16(VALUE)
 */
void UART_voidInit(void)
{
	//full dublex
	UART->CR1 |=(1<<2);
	UART->CR1 |=(1<<3);
	//sampling 16
	CLR_BIT(UART->CR1,15);
	//baudrate 9600
	//mantissa 104 , exponent 3
	UART->BRR = (104<<4) | (3);
	//one stop bit
	CLR_BIT(UART->CR2,12);
	CLR_BIT(UART->CR2,13);
	//no parity
	CLR_BIT(UART->CR1,10);

	//word size 8 bits
	CLR_BIT(UART->CR1,12);
}

void UART_voidSendByteSynchronous(u8 Copy_u8Data)
{
	while(!GET_BIT(UART->SR,7));
	UART->DR=Copy_u8Data;


}

u8 UART_u8ReciveDataByte(void)
{
	while(!GET_BIT(UART->SR,5));
	return UART->DR;

}
void UART_voidSendString(u8 *ptr)
{
	u16 Counter=0;
	while(ptr[Counter]!='\0')//while true
	{
		UART_voidSendByteSynchronous(ptr[Counter]);
		Counter++;
	}
	UART_voidSendByteSynchronous('\0');
}
void UART_voidEnable(void)
{
	SET_BIT(UART->CR1,13);
}

void UART_voidDisable(void)
{
	CLR_BIT(UART->CR1,13);
}

u8 UART_u8ReadDataSynch(u8 *Copy_u8DataCome)
{

  u8 LOC_u8Status = 1 ;
  if(GET_BIT(UART->SR,5) == 1)
  {
	  *Copy_u8DataCome = UART->DR  ;
  }
  else
  {
	  LOC_u8Status = 0 ;
  }

return  LOC_u8Status ;

}

